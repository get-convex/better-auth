---
title: React (Vite SPA)
description: Install and configure Convex + Better Auth for React.
---

<Callout>
  Check out a complete Convex + Better Auth example with React in the [GitHub
  repo](https://github.com/get-convex/better-auth/tree/main/examples/react).
</Callout>

## Installation

<div className="fd-steps">

  <div className="fd-step">
    ### Install packages

    Install the component, a pinned version of Better Auth, and ensure the latest version
    of Convex.

    <Callout>This component requires Convex `1.25.0` or later.</Callout>

    ```npm
    npm install convex@latest @convex-dev/better-auth
    npm install better-auth@1.3.27 --save-exact
    ```

  </div>

  <div className="fd-step">
    ### Register the component

    Register the Better Auth component in your Convex project.

    ```ts title="convex/convex.config.ts"
    import { defineApp } from "convex/server";
    import betterAuth from "@convex-dev/better-auth/convex.config";

    const app = defineApp();
    app.use(betterAuth);

    export default app;
    ```

  </div>

  <div className="fd-step">
    ### Add Convex auth config

    Add a `convex/auth.config.ts` file to configure Better Auth as an authentication provider.

    ```ts title="convex/auth.config.ts"
    export default {
      providers: [
        {
          domain: process.env.CONVEX_SITE_URL,
          applicationID: "convex",
        },
      ],
    };
    ```

  </div>

  <div className="fd-step">
    ### Set environment variables

    Generate a secret for encryption and generating hashes. Use the command below if you have openssl installed, or use the button to generate a random value instead. Or generate your own however you like.

    ```shell
    npx convex env set BETTER_AUTH_SECRET=$(openssl rand -base64 32)
    ```

    Add your site URL to your Convex deployment.

    ```shell
    npx convex env set SITE_URL http://localhost:5173
    ```

    Add environment variables to the `.env.local` file created by `npx convex dev`. It will be picked up by your framework dev server.

    ```shell title=".env.local" tab="Cloud"
    # Deployment used by \`npx convex dev\`
    CONVEX_DEPLOYMENT=dev:adjective-animal-123 # team: team-name, project: project-name

    VITE_CONVEX_URL=https://adjective-animal-123.convex.cloud

    # Same as VITE_CONVEX_URL but ends in .site // [!code ++]
    VITE_CONVEX_SITE_URL=https://adjective-animal-123.convex.site # [!code ++]

    # Your local site URL // [!code ++]
    SITE_URL=http://localhost:5173 # [!code ++]
    ```

    ```shell title=".env.local" tab="Self hosted"
    # Deployment used by \`npx convex dev\`
    CONVEX_DEPLOYMENT=dev:adjective-animal-123 # team: team-name, project: project-name

    VITE_CONVEX_URL=http://127.0.0.1:3210

    # Will generally be one number higher than VITE_CONVEX_URL,
    # so if your convex url is :3212, your site url will be :3213
    VITE_CONVEX_SITE_URL=http://127.0.0.1:3211 # [!code ++]

    # Your local site URL // [!code ++]
    SITE_URL=http://localhost:5173 # [!code ++]
    ```

  </div>

  <div className="fd-step">
    ### Create a Better Auth instance

    Create a Better Auth instance and initialize the component.

    <Callout>Some Typescript errors will show until you save the file.</Callout>

    ```ts title="convex/auth.ts"
    import { createClient, type GenericCtx } from "@convex-dev/better-auth";
    import { convex, crossDomain } from "@convex-dev/better-auth/plugins";
    import { components } from "./_generated/api";
    import { DataModel } from "./_generated/dataModel";
    import { query } from "./_generated/server";
    import { betterAuth } from "better-auth";

    const siteUrl = process.env.SITE_URL!;

    // The component client has methods needed for integrating Convex with Better Auth,
    // as well as helper methods for general use.
    export const authComponent = createClient<DataModel>(components.betterAuth);

    export const createAuth = (
      ctx: GenericCtx<DataModel>,
      { optionsOnly } = { optionsOnly: false },
    ) => {
      return betterAuth({
        // disable logging when createAuth is called just to generate options.
        // this is not required, but there's a lot of noise in logs without it.
        logger: {
          disabled: optionsOnly,
        },
        trustedOrigins: [siteUrl],
        database: authComponent.adapter(ctx),
        // Configure simple, non-verified email/password to get started
        emailAndPassword: {
          enabled: true,
          requireEmailVerification: false,
        },
        plugins: [
          // The cross domain plugin is required for client side frameworks
          crossDomain({ siteUrl }),
          // The Convex plugin is required for Convex compatibility
          convex(),
        ],
      });
    };

    // Example function for getting the current user
    // Feel free to edit, omit, etc.
    export const getCurrentUser = query({
      args: {},
      handler: async (ctx) => {
        return authComponent.getAuthUser(ctx);
      },
    });
    ```

  </div>

  <div className="fd-step">
    ### Create a Better Auth client instance

    Create a Better Auth client instance for interacting with the Better Auth server from your client.

    ```ts title="src/lib/auth-client.ts"
    import { createAuthClient } from "better-auth/react";
    import {
      convexClient,
      crossDomainClient,
    } from "@convex-dev/better-auth/client/plugins";

    export const authClient = createAuthClient({
      baseURL: import.meta.env.VITE_CONVEX_SITE_URL,
      plugins: [convexClient(), crossDomainClient()],
    });
    ```

  </div>

  <div className="fd-step">
    ### Mount handlers

    Register Better Auth route handlers on your Convex deployment.

    ```ts title="convex/http.ts"
    import { httpRouter } from "convex/server";
    import { authComponent, createAuth } from "./auth";

    const http = httpRouter();

    // CORS handling is required for client side frameworks
    authComponent.registerRoutes(http, createAuth, { cors: true });

    export default http;
    ```

  </div>

  <div className="fd-step">
    ### Set up Convex client provider

    Wrap your app with the `ConvexBetterAuthProvider` component.

    ```ts title="src/main.tsx"
    import React from "react";
    import ReactDOM from "react-dom/client";
    import App from "./App";
    import "./index.css";
    import { ConvexReactClient } from "convex/react";
    import { ConvexBetterAuthProvider } from "@convex-dev/better-auth/react"; // [!code ++]
    import { authClient } from "@/lib/auth-client"; // [!code ++]

    const convex = new ConvexReactClient(import.meta.env.VITE_CONVEX_URL as string, {
      // Optionally pause queries until the user is authenticated // [!code ++]
      expectAuth: true, // [!code ++]
    });

    ReactDOM.createRoot(document.getElementById("root")!).render(
      <React.StrictMode>
        <ConvexBetterAuthProvider client={convex} authClient={authClient}> // [!code ++]
          <App />
        </ConvexBetterAuthProvider> // [!code ++]
      </React.StrictMode>
    );
    ```

  </div>
</div>

### You're done!

You're now ready to start using Better Auth with Convex.

## Usage

Check out the [Basic Usage](/basic-usage) guide for more information on general
usage. Below are usage notes specific to React SPAs.

### Social sign-in

Social sign-in for React SPAs works the same as with full stack frameworks, but the
authorized redirect URI is based on your Convex site URL instead of your application domain.

For example, with
[Google sign-in](https://www.better-auth.com/docs/authentication/google), the authorized
redirect URI would look like:

```
https://adjective-animal-123.convex.site/api/auth/callback/google
```
